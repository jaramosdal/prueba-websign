const a0_0x43d3a9=a0_0x6d21;function a0_0x6d21(_0x197e62,_0x55fa01){const _0x393ea1=a0_0x393e();return a0_0x6d21=function(_0x6d212f,_0x29ab32){_0x6d212f=_0x6d212f-0x1dd;let _0x251fae=_0x393ea1[_0x6d212f];return _0x251fae;},a0_0x6d21(_0x197e62,_0x55fa01);}(function(_0x48c687,_0x3cf32d){const _0x542f6c=a0_0x6d21,_0x4be9a8=_0x48c687();while(!![]){try{const _0x11006a=-parseInt(_0x542f6c(0x232))/0x1*(parseInt(_0x542f6c(0x2cb))/0x2)+parseInt(_0x542f6c(0x2f8))/0x3*(parseInt(_0x542f6c(0x2a9))/0x4)+parseInt(_0x542f6c(0x2b2))/0x5*(parseInt(_0x542f6c(0x1dd))/0x6)+parseInt(_0x542f6c(0x313))/0x7*(-parseInt(_0x542f6c(0x210))/0x8)+parseInt(_0x542f6c(0x29c))/0x9*(-parseInt(_0x542f6c(0x270))/0xa)+parseInt(_0x542f6c(0x280))/0xb+parseInt(_0x542f6c(0x273))/0xc;if(_0x11006a===_0x3cf32d)break;else _0x4be9a8['push'](_0x4be9a8['shift']());}catch(_0x717d51){_0x4be9a8['push'](_0x4be9a8['shift']());}}}(a0_0x393e,0x92bcc));function a0_0x393e(){const _0x1b39f2=['#websign-floating-buttons','includes','websign-setEdataliaSignatureSignerConfig','str','ebpServiceUrl','noConflict','#websign-overlay','result','css','varInitialEbp','url','round','length','convertToViewportPoint','blackAndWhiteScreenSaver','stu','Initialized','currentScaleValue','websign-showPositionateMessage','173','init','signature','pageNumber','#websign-page-','websign-disabled-events','pen','manual','Display','appendChild','enableInitialEbp','top','./web-sign-config.json','#websign-fab-sign','clientHeight','#ecf5ff','90rguZfn','error','onError','16860120EYEmLQ','accept','enableScreenSaver','float\x20text\x20','./build/pdf.js','websign-getTextPageCoordinates','style','onload','field','minPointsRequiredToSignMultipier','0.6','scrollTop','div\x20with\x20id:\x20web-sign\x20not\x20defined','6673117RzFyGN','attr','split','#websign-snackbar','Posiciona\x20y/o\x20reescala\x20la\x20caja\x20de\x20firma\x20en\x20la\x20p√°gina','websign-clearSignature','doCaptureFromSTU','#web-sign','transform','autoDownload','addClass','pdfViewer','#websign-loader-container','currentScale','blackAndWhiteEbp','getElementById','loading','websign-signature-clear','application/json','./web/images/annotation-eraser.svg','backgroundColor','catch','contains','websign-updateSignatureCoordinates','onWorking','rendered','websign-createSignatureButtons\x20checking\x20websign-signature-text\x20to\x20remove\x20it','float','1080459TBPfFc','colorEBP','websign-document.pdf','varEbp','1px\x20solid\x20#000000','initializedPromise','important','websign-createSignatureButtons\x20remove\x20websign-signature-text','author','websign-showSnackbar','signed','append','stringify','116EUUpCC','websign-initSigner\x20getting\x20pdf\x20base64','WebSign','WebSignWidgetType','pathname','resizable','./web/viewer.js','colorScreenSaver','varEBP','1130QfthPr','getSignatureBaseUrl','removeEventListener','Positioned','websign-getBase64FromFilePath','then','./modules/edatalia-stu-signer/src/config_edatalia_stu_signer.js','0px','./web/images/annotation-check-bold.svg','onerror','json','websign-getPDFSignatureCoordinates','metaKey','colorEbp','colorInitialEbp','signatureType','pdfDocument','containerHeight','cancel','options','body','websign-initSigner','websign-createSignature\x20status\x20is\x20not\x20appended\x20so\x20we\x20center\x20pdf\x20on\x20screen\x20without\x20reescaling','web-sign','websign-signature','777694gvDkxR','getPage','pointer','SANDBOX','onPreSigned','websign-signature-buttons','Fixed','#websign-signature-buttons',',\x20retry:\x20','25px','./build/jquery-ui.min.js','touchmove','show','websign-onOkSignatureclick\x20signature\x20is\x20positioned,\x20accept','initialized','log','#websign-signature-container','WebSign\x20v','websign-initSigner\x20previously\x20configured\x20so\x20just\x20update\x20with\x20new\x20values','websign-PDFCoordsToScreenCoords','disable','107','websign-screenCoordsToPDFCoords','Float','PRO','./build/jquery-ui-touch-punch.min.js','getDataWithAnnotations','websign-initSigner\x20onCancel','onLoadingStuImage','https://restapi.firmar.info/eSign/v40/','./modules/edatalia-stu-signer/src/edatalia_stu_signer.js','customText','Response\x20status:\x20','opened','page','android','#websign-main-container','which','blackAndWhiteInitialEbp','#A20006','auto','Realiza\x20la\x20firma\x20en\x20la\x20caja','head','./build/jquery-ui.min.css','b64SignatureImage','36489qLPMzJ','getElementsByTagName','createElement','draggable','<img>','wacom','websign-initSigner\x20onWorking','ctrlKey','eventBus','https://restapi.firmar.online/eSign/v40/','readAsDataURL','onInitialized','remove','109','floatText','websign-loadJQuery','websign-disabled','#0057A2','createObjectURL','crosshair','websign-pdfDataToBase64','WebSignSignatureType','websign-loadEdataliaSignatureKitHtml','websign-createSignatureButtons\x20shouldDrawClearButton\x20','<div>','Appended','21px','809179LNeaha','XYZ','script','enableScreenSaverImage','websign-initSigner\x20not\x20configuredconfig\x20all\x20values\x20and\x20callbacks','onDisconnected','10px','#B00020','wheel\x20mousewheel','signatureServiceURL','properties','websign-initSigner\x20onDisconnected','31254oXszrN','websign-checkScrollZoomCompletion','appendTo','#websign-fab-cancel','Bearer\x20','websign-overrideConfigEdataliaSTUSigner','width','stopImmediatePropagation','websign-initSigner\x20onError','application/pdf','websign-loader','websign-downloadURI','GET','189','websign-onOkSignatureclick\x20signature\x20container\x20div\x20exists','removeChild','containerWidth','open','websign-resetSignature','websign-createSignatureContainer','websign-showSuccessSignatureMessage','onloadend','<p>','websign-createSignature\x20status:\x20','clientWidth','downloadURI','contact','userAgent','websign-showErrorSignatureMessage','width\x200s\x20ease','clear','editorSignature','removeClass','preventDefault','onNoTabletFound','getPageView','websign-createSignatureButtons','onCapturedPoints','websign-initSigner\x20onInitialized','websign-captureSignature','href','hide','addEventListener','#websign-fab-ok','mouseenter','left','websign-init','websign-initSigner\x20onPreSigned','origin','enableInitialEBP','download','48vDCfEQ','ajax','websign-signature-text','websign-showDrawSignatureMessage','saveDocument','websign-createSignatureContainer\x20signaturePage\x20was\x20not\x20found\x20so,\x20we\x20set\x20values','#websign-viewer-container','#websign-signature','https://restapi.ecosignature.biz/eSign/v40/','websign-setLoading','gapX','keydown','300px','red','websign-initSigner\x20status\x20=\x20positioned','minPointsRequiredToSign','websign-configureWidgetFloat','name','certificate','center','version','status','websign-initSigner\x20got\x20pdf\x20base64','load','enableEBP','widget','fadeIn','websign-setSignerMode','viewport','blob','websign-antidisabled','click','min','colorInitialEBP','3AdgdqU','type','wheel','none','convertToPdfPoint','noDeviceFound','WebSignStatus','timestampProvider','height','varInitialEBP','STU','items','websign-signature-container','fixed','websign-onOkSignatureclick','pdfB64','websign-loadSyncScript','src','#websign-fab-clear','doCaptureFromCanvas','websign-initSigner\x20waitForElement\x20websign-signature','positioned','location','text','Widget','absolute','setConfig'];a0_0x393e=function(){return _0x1b39f2;};return a0_0x393e();}export default class WebSign{[a0_0x43d3a9(0x238)]={'Initialized':a0_0x43d3a9(0x2d9),'Appended':'appended','Positioned':a0_0x43d3a9(0x247)};[a0_0x43d3a9(0x30d)]={'Display':'display','STU':a0_0x43d3a9(0x25c)};[a0_0x43d3a9(0x2ac)]={'Manual':a0_0x43d3a9(0x267),'Fixed':a0_0x43d3a9(0x23f),'Float':a0_0x43d3a9(0x29b),'Field':a0_0x43d3a9(0x27b)};#snackbar;#snackbarTimeout;#signaturePositioned;#$;#isAtLeastOnePageRendered;#file;#callback;#signatureConfigAppended;#signaturePageView;#signaturePage;#edataliaSigner;#edataliaSignerConfig;#status;#webSignConfig;#configWidthPx;#configHeightPx;constructor(_0x43d7c5,_0x40920d,_0x3f396a=null){this.#file=_0x43d7c5,this.#callback=_0x40920d,this.#webSignConfig=_0x3f396a,this.#isAtLeastOnePageRendered=![],this.#init();}#loadEdataliaSignatureKitHtml(){const _0x38c55b=a0_0x43d3a9;return this.#consoleLog(_0x38c55b(0x30e)),new Promise(_0x263d56=>{const _0x20514f=_0x38c55b;this.#$(_0x20514f(0x287))[_0x20514f(0x255)]({'width':this.#webSignConfig[_0x20514f(0x1ed)],'height':this.#webSignConfig[_0x20514f(0x2c3)],'minWidth':_0x20514f(0x21c)}),this.#$(_0x20514f(0x287))[_0x20514f(0x227)](new URL('./modules/web-sign/web-sign.html',import.meta[_0x20514f(0x257)])['pathname'],()=>{_0x263d56();});});}async #init(){const _0x3b6a35=a0_0x43d3a9;this.#consoleLog(_0x3b6a35(0x20b));const _0x188af8=await fetch(new URL('./package.json',import.meta[_0x3b6a35(0x257)])[_0x3b6a35(0x2ad)]),_0x14e489=await _0x188af8['json']();console['log'](_0x3b6a35(0x2dc)+_0x14e489[_0x3b6a35(0x224)]),await this.#initConfig();let _0x70ca0f=URL[_0x3b6a35(0x30a)](this.#file);await this.#loadJQuery(),await this.#loadEdataliaSignatureKitHtml(),await this.#loadSyncScript(new URL(_0x3b6a35(0x277),import.meta[_0x3b6a35(0x257)])[_0x3b6a35(0x2ad)]),await this.#loadSyncScript(new URL(_0x3b6a35(0x2af),import.meta['url'])[_0x3b6a35(0x2ad)],!![]),await PDFViewerApplication[_0x3b6a35(0x2a1)],this.#snackbar=this.#$(_0x3b6a35(0x283)),this.#snackbar[_0x3b6a35(0x209)](()=>{const _0x3264bb=_0x3b6a35;this.#snackbar[_0x3264bb(0x206)]();}),await PDFViewerApplication['open']({'url':_0x70ca0f,'originalUrl':this.#file[_0x3b6a35(0x221)]}),this.#callback({'type':_0x3b6a35(0x2ec)}),await this.#configureWidgetFloat(),this.#resetSignature(),PDFViewerApplication[_0x3b6a35(0x300)]['on']('pagerendered',_0x2bd522=>{const _0x4155d9=_0x3b6a35;!this.#isAtLeastOnePageRendered&&(this.#consoleLog('websign-first\x20page\x20rendered,\x20make\x20scrollTop\x20to\x200\x20and\x20scale\x20value\x20auto'),this.#isAtLeastOnePageRendered=!![],PDFViewerApplication[_0x4155d9(0x28b)][_0x4155d9(0x25e)]=_0x4155d9(0x2f3),document[_0x4155d9(0x28f)]('websign-viewer-container')[_0x4155d9(0x27e)]=0x0,this.#callback({'type':_0x4155d9(0x299)})),this.#signaturePage==_0x2bd522[_0x4155d9(0x263)]&&(this.#consoleLog('websign-recreate\x20signature\x20signature\x20cause\x20zoom\x20and\x20signature\x20exists'),this.#createSignatureContainer());}),PDFViewerApplication[_0x3b6a35(0x300)]['on'](_0x3b6a35(0x1fc),_0x4f0f9b=>{this.#onOkSignatureClick();}),this.#$('#websign-fab-sign')[_0x3b6a35(0x22f)](_0x5bb79f=>{this.#onOkSignatureClick();}),this.#$(_0x3b6a35(0x208))[_0x3b6a35(0x22f)](_0x2a02ed=>{this.#onOkSignatureClick();}),this.#$(_0x3b6a35(0x1e0))[_0x3b6a35(0x22f)](_0x1a118b=>{this.#resetSignature();}),this.#$(_0x3b6a35(0x244))[_0x3b6a35(0x22f)](_0xc1f2a9=>{this.#clearSignature();}),this.#status=this[_0x3b6a35(0x238)][_0x3b6a35(0x25d)],this.#consoleLog('websign-init\x20status\x20=\x20initialized'),this.#callback({'type':'initialized'});var _0x5d0ace=this;this.#$(window)['on']('orientationchange',function(_0x49561b){const _0x569ce9=_0x3b6a35;_0x5d0ace.#status===_0x5d0ace[_0x569ce9(0x238)][_0x569ce9(0x2b5)]&&(this.#consoleLog('websign-orientationchange\x20reset\x20signature\x20if\x20was\x20positioned'),_0x5d0ace.#resetSignature());});}async #initConfig(){const _0x3b78c8=a0_0x43d3a9;this.#consoleLog('websign-initConfig');document[_0x3b78c8(0x28f)](_0x3b78c8(0x2c9))===null&&this.#callback({'type':_0x3b78c8(0x271),'error':_0x3b78c8(0x27f)});if(this.#webSignConfig===null){const _0x5b5279=await fetch(new URL(_0x3b78c8(0x26c),import.meta[_0x3b78c8(0x257)])[_0x3b78c8(0x2ad)]),_0xb895e3=await _0x5b5279[_0x3b78c8(0x2bc)]();this.#webSignConfig=_0xb895e3;}}async #configureWidgetFloat(){const _0x462f3a=a0_0x43d3a9;this.#consoleLog(_0x462f3a(0x220));if(this.#webSignConfig[_0x462f3a(0x229)]['type']===this[_0x462f3a(0x2ac)][_0x462f3a(0x2e2)]){let _0x2bdba0=await this.#getTextPageCoordinates();_0x2bdba0===null?this.#callback({'type':'error','error':_0x462f3a(0x276)+this.#webSignConfig[_0x462f3a(0x229)][_0x462f3a(0x306)]+'\x20not\x20found'}):(this.#webSignConfig[_0x462f3a(0x229)][_0x462f3a(0x2ed)]=_0x2bdba0[0x0],this.#webSignConfig['widget']['x']=_0x2bdba0[0x1]+this.#webSignConfig['widget'][_0x462f3a(0x21a)],this.#webSignConfig[_0x462f3a(0x229)]['y']=_0x2bdba0[0x2]-this.#webSignConfig[_0x462f3a(0x229)][_0x462f3a(0x23a)]-this.#webSignConfig['widget']['gapY'],this.#webSignConfig[_0x462f3a(0x229)]['y']<0x0&&(this.#webSignConfig[_0x462f3a(0x229)]['y']=0x0),this.#webSignConfig[_0x462f3a(0x229)]['x']<0x0&&(this.#webSignConfig[_0x462f3a(0x229)]['x']=0x0));}}async #onOkSignatureClick(){const _0x487feb=a0_0x43d3a9;this.#consoleLog(_0x487feb(0x240));let _0x5a6280=this.#$(_0x487feb(0x2db));this.#enableButtons();if(_0x5a6280[_0x487feb(0x259)]){this.#consoleLog(_0x487feb(0x1eb));if(this.#status===this[_0x487feb(0x238)][_0x487feb(0x2b5)]){this.#consoleLog(_0x487feb(0x2d8)),this.#edataliaSigner[_0x487feb(0x274)]();return;}this.#consoleLog('websign-onOkSignatureclick\x20signature\x20is\x20not\x20positioned:\x20'+this.#status),await this.#centersPdfOnScreenBasedOnSignature(!![]),this.#initSigner(),document[_0x487feb(0x28f)](_0x487feb(0x23e))[_0x487feb(0x279)]['setProperty']('z-index','1003',_0x487feb(0x2a2));return;}this.#createSignatureContainer();if(this.#signaturePositioned){this.#onOkSignatureClick();return;}this.#$('#websign-fab-sign')[_0x487feb(0x206)](0x1f4),this.#$(_0x487feb(0x208))[_0x487feb(0x2d7)](0x1f4),this.#$(_0x487feb(0x1e0))['show'](0x1f4);if(this.#webSignConfig[_0x487feb(0x229)]['type']===this[_0x487feb(0x2ac)][_0x487feb(0x2d1)]||this.#webSignConfig['widget'][_0x487feb(0x233)]===this[_0x487feb(0x2ac)][_0x487feb(0x2e2)]){this.#onOkSignatureClick();return;}this.#signaturePositioned=!![],this.#showPositionateMessage();}#preventZoomMouse(_0x4b98e7){const _0x5ae80d=a0_0x43d3a9;_0x4b98e7['ctrlKey']&&(_0x4b98e7[_0x5ae80d(0x1e4)](),_0x4b98e7[_0x5ae80d(0x1fe)]());}#preventCntrlZoom(_0x282449){const _0x431207=a0_0x43d3a9;(_0x282449[_0x431207(0x2ff)]==!![]||_0x282449[_0x431207(0x2be)])&&(_0x282449[_0x431207(0x2f0)]=='61'||_0x282449[_0x431207(0x2f0)]==_0x431207(0x2e0)||_0x282449[_0x431207(0x2f0)]==_0x431207(0x260)||_0x282449[_0x431207(0x2f0)]==_0x431207(0x305)||_0x282449[_0x431207(0x2f0)]=='187'||_0x282449[_0x431207(0x2f0)]==_0x431207(0x1ea))&&(_0x282449['preventDefault'](),_0x282449[_0x431207(0x1e4)]());}#preventMobileZoom(_0x8f8a06){const _0x3a3fec=a0_0x43d3a9;_0x8f8a06[_0x3a3fec(0x1fe)](),_0x8f8a06[_0x3a3fec(0x1e4)]();}#setSignerMode(){const _0x341eea=a0_0x43d3a9;this.#consoleLog(_0x341eea(0x22b));document[_0x341eea(0x296)](document[_0x341eea(0x28f)](_0x341eea(0x212)))&&document[_0x341eea(0x28f)]('websign-signature-text')['remove']();;this.#$(_0x341eea(0x253))[_0x341eea(0x2d7)](),this.#$(_0x341eea(0x2ef))[_0x341eea(0x28a)](_0x341eea(0x265)),this.#$('#websign-signature')['css']({'cursor':_0x341eea(0x30b)}),this.#$(_0x341eea(0x217))[_0x341eea(0x2fb)](_0x341eea(0x2df)),this.#$('#websign-signature')[_0x341eea(0x2ae)](_0x341eea(0x2df)),this.#$('#websign-signature')['on'](_0x341eea(0x31b),function(_0x16840f){_0x16840f['preventDefault']();}),document['addEventListener'](_0x341eea(0x2d6),this.#preventMobileZoom),document[_0x341eea(0x207)](_0x341eea(0x234),this.#preventZoomMouse,{'passive':![]}),document[_0x341eea(0x207)]('keydown',this.#preventCntrlZoom);}async #getBase64FromFilePath(_0x2ae49b){const _0x968b04=a0_0x43d3a9;return this.#consoleLog(_0x968b04(0x2b6)),new Promise((_0x149fb6,_0x42c443)=>{const _0x27a56d=_0x968b04;fetch(_0x2ae49b)['then'](_0x250be9=>_0x250be9[_0x27a56d(0x22d)]()[_0x27a56d(0x2b7)](_0xcc9b5a=>{const _0x3a6e83=_0x27a56d,_0x3dbf5c=new FileReader();_0x3dbf5c[_0x3a6e83(0x1f2)]=()=>{const _0x430eb5=_0x3a6e83;_0x149fb6(_0x3dbf5c[_0x430eb5(0x254)][_0x430eb5(0x282)](',')[0x1]);},_0x3dbf5c['onerror']=_0x42c443,_0x3dbf5c[_0x3a6e83(0x302)](_0xcc9b5a);}))[_0x27a56d(0x295)](_0x138f41=>{_0x42c443(_0x138f41);});});}async #overrideConfigEdataliaSTUSigner(){const _0x4f115b=a0_0x43d3a9;this.#consoleLog(_0x4f115b(0x1e2));if(this.#edataliaSignerConfig&&this.#webSignConfig){this.#setEdataliaSignatureSignerConfig();if(this.#webSignConfig[_0x4f115b(0x2c1)]===this['WebSignSignatureType']['STU']){this.#edataliaSignerConfig[_0x4f115b(0x31c)]=this.#webSignConfig[_0x4f115b(0x2fd)]['ebpServiceSignatureUrl'],this.#edataliaSignerConfig[_0x4f115b(0x25c)]['EBPServiceURL']=this.#webSignConfig[_0x4f115b(0x2fd)][_0x4f115b(0x251)],this.#edataliaSignerConfig[_0x4f115b(0x25c)][_0x4f115b(0x25b)]=this.#webSignConfig[_0x4f115b(0x25b)],this.#edataliaSignerConfig[_0x4f115b(0x25c)][_0x4f115b(0x316)]=this.#webSignConfig[_0x4f115b(0x2fd)][_0x4f115b(0x275)],this.#edataliaSignerConfig['stu']['colorImageScreenSaver']=this.#webSignConfig[_0x4f115b(0x2fd)][_0x4f115b(0x2b0)],this.#edataliaSignerConfig[_0x4f115b(0x25c)][_0x4f115b(0x228)]=this.#webSignConfig[_0x4f115b(0x2fd)]['enableEbp'];const _0x1324a7=await this.#getBase64FromFilePath(this.#webSignConfig[_0x4f115b(0x2fd)][_0x4f115b(0x28e)]),_0x5261b2=await this.#getBase64FromFilePath(this.#webSignConfig[_0x4f115b(0x2fd)][_0x4f115b(0x2bf)]),_0x53b48e=await this.#getBase64FromFilePath(this.#webSignConfig[_0x4f115b(0x2fd)][_0x4f115b(0x2f1)]),_0x44265b=await this.#getBase64FromFilePath(this.#webSignConfig['wacom'][_0x4f115b(0x2c0)]);this.#edataliaSignerConfig[_0x4f115b(0x25c)]['blackAndWhiteEbp']=_0x1324a7,this.#edataliaSignerConfig['stu'][_0x4f115b(0x29d)]=_0x5261b2,this.#edataliaSignerConfig[_0x4f115b(0x25c)][_0x4f115b(0x2b1)]=this.#webSignConfig[_0x4f115b(0x2fd)][_0x4f115b(0x29f)],this.#edataliaSignerConfig['stu'][_0x4f115b(0x20e)]=this.#webSignConfig['wacom'][_0x4f115b(0x26a)],this.#edataliaSignerConfig[_0x4f115b(0x25c)]['blackAndWhiteInitialEbp']=_0x53b48e,this.#edataliaSignerConfig[_0x4f115b(0x25c)][_0x4f115b(0x231)]=_0x44265b,this.#edataliaSignerConfig[_0x4f115b(0x25c)][_0x4f115b(0x23b)]=this.#webSignConfig[_0x4f115b(0x2fd)][_0x4f115b(0x256)],this.#edataliaSignerConfig[_0x4f115b(0x25c)][_0x4f115b(0x27c)]=this.#webSignConfig[_0x4f115b(0x2fd)]['minPointsRequiredToSignMultipier'];}}}#setEdataliaSignatureSignerConfig(){const _0x5356d3=a0_0x43d3a9;this.#consoleLog(_0x5356d3(0x24f)),this.#edataliaSignerConfig['signature']['Widget']['page']=this.#signaturePage,this.#edataliaSignerConfig[_0x5356d3(0x262)]['Widget']['x']=Math[_0x5356d3(0x258)](this.#signatureConfigAppended['x']),this.#edataliaSignerConfig['signature']['Widget']['y']=Math[_0x5356d3(0x258)](this.#signatureConfigAppended['y']),this.#edataliaSignerConfig[_0x5356d3(0x262)]['Widget']['width']=Math[_0x5356d3(0x258)](this.#signatureConfigAppended[_0x5356d3(0x1e3)]),this.#edataliaSignerConfig[_0x5356d3(0x262)][_0x5356d3(0x24a)][_0x5356d3(0x23a)]=Math['round'](this.#signatureConfigAppended[_0x5356d3(0x23a)]),this.#edataliaSignerConfig[_0x5356d3(0x1e3)]=this.#configWidthPx,this.#edataliaSignerConfig[_0x5356d3(0x23a)]=this.#configHeightPx,this.#edataliaSignerConfig[_0x5356d3(0x266)]={'color':this.#webSignConfig['signatureColorHex']},this.#edataliaSignerConfig[_0x5356d3(0x262)][_0x5356d3(0x24a)]['customText']=this.#webSignConfig[_0x5356d3(0x229)]['customText'],this.#edataliaSignerConfig[_0x5356d3(0x21f)]=this.#webSignConfig[_0x5356d3(0x21f)],this.#edataliaSignerConfig[_0x5356d3(0x2c1)]=this.#webSignConfig[_0x5356d3(0x2c1)];}#waitForElement(_0x47a144){let _0x1f67f9=0x1;return new Promise(_0x46ecc5=>{const _0x7f87f3=setInterval(()=>{const _0x12b1af=a0_0x6d21,_0x1a7e00=document[_0x12b1af(0x28f)](_0x47a144);console[_0x12b1af(0x2da)]('checking\x20'+_0x47a144+_0x12b1af(0x2d3)+_0x1f67f9),_0x1a7e00?(clearInterval(_0x7f87f3),_0x46ecc5(_0x1a7e00)):_0x1f67f9++;},0x64);});}async #initSigner(){const _0x44b4a2=a0_0x43d3a9;this.#consoleLog(_0x44b4a2(0x2c7)),this.#setLoading(!![]),this.#consoleLog(_0x44b4a2(0x246)),await this.#waitForElement(_0x44b4a2(0x2ca)),this.#consoleLog('websign-initSigner\x20websign-signature\x20element\x20found'),this.#$(_0x44b4a2(0x244))['show'](0x1f4),this.#consoleLog(_0x44b4a2(0x2aa));const _0x4f0da3=await PDFViewerApplication[_0x44b4a2(0x2c2)][_0x44b4a2(0x2e5)](),_0xa07860=await this.#pdfDataToBase64(_0x4f0da3);this.#consoleLog(_0x44b4a2(0x226)),this.#status=this[_0x44b4a2(0x238)][_0x44b4a2(0x2b5)],this.#consoleLog(_0x44b4a2(0x21e)),this.#createSignatureButtons();if(this.#edataliaSigner&&this.#edataliaSignerConfig){this.#consoleLog(_0x44b4a2(0x2dd)),this.#setLoading(![]),this.#setSignerMode(),this.#setEdataliaSignatureSignerConfig(),this.#edataliaSigner[_0x44b4a2(0x24c)](this.#edataliaSignerConfig),this.#edataliaSigner['setPDFB64'](_0xa07860),this.#captureSignature(),this.#showDrawSignatureMessage();return;}this.#consoleLog(_0x44b4a2(0x317)),await this.#loadSyncScript(new URL(_0x44b4a2(0x2b8),import.meta[_0x44b4a2(0x257)])['pathname']),await this.#loadSyncScript(new URL(_0x44b4a2(0x2e9),import.meta[_0x44b4a2(0x257)])[_0x44b4a2(0x2ad)]),this.#edataliaSignerConfig=new Config_EdataliaSTUSigner(),await this.#overrideConfigEdataliaSTUSigner(),this.#edataliaSigner=new EdataliaSTUSigner(_0xa07860,this.#edataliaSignerConfig,this.#webSignConfig['signatureType'],async _0x4e0b4c=>{const _0x7ad77=_0x44b4a2;switch(_0x4e0b4c[_0x7ad77(0x233)]){case _0x7ad77(0x303):this.#consoleLog(_0x7ad77(0x203)),this.#setSignerMode(),this.#setLoading(![]),this.#showDrawSignatureMessage(),this.#captureSignature();break;case _0x7ad77(0x298):this.#consoleLog(_0x7ad77(0x2fe)),this.#setLoading(!![]);break;case _0x7ad77(0x1ff):this.#consoleLog('websign-initSigner\x20onNoTabletFound'),this.#callback({'type':_0x7ad77(0x271),'error':_0x7ad77(0x237)}),this.#setLoading(![]),this.#resetSignature();break;case _0x7ad77(0x272):this.#consoleLog(_0x7ad77(0x1e5)),this.#resetSignature(),this.#setLoading(![]),this.#showErrorSignatureMessage(_0x4e0b4c[_0x7ad77(0x271)]),this.#callback({'type':_0x7ad77(0x271),'error':_0x4e0b4c['error']});break;case _0x7ad77(0x202):this.#showErrorSignatureMessage(_0x4e0b4c['error']);break;case'onCancel':this.#consoleLog(_0x7ad77(0x2e6));this.#status!=this[_0x7ad77(0x238)][_0x7ad77(0x25d)]&&(this.#resetSignature(),this.#setLoading(![]));break;case _0x7ad77(0x318):this.#consoleLog(_0x7ad77(0x31e)),this.#resetSignature(),this.#setLoading(![]);break;case _0x7ad77(0x2cf):this.#consoleLog(_0x7ad77(0x20c)),this.#signDocument(this.#edataliaSigner[_0x7ad77(0x241)],_0x4e0b4c['b64PublicWebSignData'],_0x4e0b4c['b64PrivateWebSignData'],_0x4e0b4c[_0x7ad77(0x2f7)]);break;case _0x7ad77(0x2e7):_0x4e0b4c[_0x7ad77(0x290)]?this.#disableButtons():this.#enableButtons();default:break;};}),await this.#edataliaSigner[_0x44b4a2(0x261)]();}async #processCommonOnSigned(_0x42f8b8){const _0x161846=a0_0x43d3a9;this.#showSuccessSignatureMessage(),this.#resetSignature(),this.#setLoading(![]);const _0x2ecb02=URL[_0x161846(0x30a)](_0x42f8b8);this.#webSignConfig[_0x161846(0x289)]&&this[_0x161846(0x1f6)](_0x2ecb02,_0x161846(0x29e)),await PDFViewerApplication[_0x161846(0x1ee)]({'url':_0x2ecb02}),this.#callback({'type':_0x161846(0x2a6),'data':_0x42f8b8});}#captureSignature(){const _0x8b1631=a0_0x43d3a9;this.#consoleLog(_0x8b1631(0x204));if(this.#webSignConfig['signatureType']==this[_0x8b1631(0x30d)][_0x8b1631(0x268)])this.#consoleLog('websign-captureSignature\x20display'),this.#edataliaSigner[_0x8b1631(0x245)]();else this.#webSignConfig[_0x8b1631(0x2c1)]==this['WebSignSignatureType'][_0x8b1631(0x23c)]&&(this.#consoleLog('websign-captureSignature\x20stu'),this.#edataliaSigner[_0x8b1631(0x286)]());}#showPositionateMessage(){const _0x3043a4=a0_0x43d3a9;this.#consoleLog(_0x3043a4(0x25f)),this.#snackbar[_0x3043a4(0x249)]('Posiciona\x20y/o\x20reescala\x20la\x20caja\x20de\x20firma\x20en\x20la\x20p√°gina'),this.#snackbar[_0x3043a4(0x255)]('backgroundColor',_0x3043a4(0x309)),this.#showSnackbar();}#showErrorSignatureMessage(_0x5a8784){const _0x267013=a0_0x43d3a9;this.#consoleLog(_0x267013(0x1f9)),this.#snackbar[_0x267013(0x249)](_0x5a8784),this.#snackbar['css'](_0x267013(0x294),_0x267013(0x2f2)),this.#showSnackbar();}#showSuccessSignatureMessage(){const _0xb47280=a0_0x43d3a9;this.#consoleLog(_0xb47280(0x1f1)),this.#snackbar[_0xb47280(0x249)]('Firma\x20realizada\x20correctamente'),this.#snackbar[_0xb47280(0x255)](_0xb47280(0x294),'#0057A2'),this.#showSnackbar();}#showDrawSignatureMessage(){const _0x42fcc5=a0_0x43d3a9;this.#consoleLog(_0x42fcc5(0x213)),this.#snackbar['text'](_0x42fcc5(0x2f4)),this.#snackbar[_0x42fcc5(0x255)](_0x42fcc5(0x294),_0x42fcc5(0x309)),this.#showSnackbar();}#showSnackbar(){const _0x35df26=a0_0x43d3a9;this.#consoleLog(_0x35df26(0x2a5)),this.#snackbarTimeout&&clearTimeout(this.#snackbarTimeout),this.#snackbar[_0x35df26(0x22a)](),this.#snackbarTimeout=setTimeout(()=>{this.#snackbar['fadeOut']();},0xbb8);}#consoleLog(_0x690c5d){const _0x5d7f33=a0_0x43d3a9;console[_0x5d7f33(0x2da)](_0x690c5d);}#createSignatureContainer(){const _0x3deb5c=a0_0x43d3a9;this.#consoleLog(_0x3deb5c(0x1f0)),this.#$(_0x3deb5c(0x2db))[_0x3deb5c(0x304)]();!this.#signaturePage&&(this.#consoleLog(_0x3deb5c(0x215)),this.#webSignConfig['widget'][_0x3deb5c(0x233)]===this[_0x3deb5c(0x2ac)][_0x3deb5c(0x2d1)]||this.#webSignConfig[_0x3deb5c(0x229)][_0x3deb5c(0x233)]===this[_0x3deb5c(0x2ac)][_0x3deb5c(0x2e2)]?this.#signaturePage=this.#webSignConfig[_0x3deb5c(0x229)][_0x3deb5c(0x2ed)]:this.#signaturePage=PDFViewerApplication[_0x3deb5c(0x2ed)]);var _0x10faea=this.#signaturePage-0x1;this.#signaturePageView=PDFViewerApplication[_0x3deb5c(0x28b)][_0x3deb5c(0x200)](_0x10faea);const _0x432c72=this.#$(_0x3deb5c(0x264)+this.#signaturePage);let _0x2c38f7=this.#$(_0x3deb5c(0x310),{'id':_0x3deb5c(0x23e)})[_0x3deb5c(0x1df)](_0x432c72);_0x2c38f7[_0x3deb5c(0x255)]({'position':'absolute','width':_0x432c72['width'](),'height':_0x432c72[_0x3deb5c(0x23a)](),'top':_0x3deb5c(0x2b9),'left':'0px','zIndex':0x3ea}),this.#createSignature();}#createSignature(){const _0x14a95d=a0_0x43d3a9;this.#consoleLog('websign-createSignature');let _0x256a28;this.#consoleLog(_0x14a95d(0x1f4)+this.#status);this.#status===this[_0x14a95d(0x238)][_0x14a95d(0x311)]?_0x256a28=this.#PDFCoordsToScreenCoords(new EPKCoordintates(this.#signatureConfigAppended['x'],this.#signatureConfigAppended['y'],this.#signatureConfigAppended['x']+this.#signatureConfigAppended['width'],this.#signatureConfigAppended[_0x14a95d(0x23a)]+this.#signatureConfigAppended['y'])):((this.#signatureConfigAppended['x']==null||this.#signatureConfigAppended['y']==null)&&this.#positionateSignatureOnPDFPage(),_0x256a28=this.#PDFCoordsToScreenCoords(new EPKCoordintates(this.#signatureConfigAppended['x'],this.#signatureConfigAppended['y'],this.#signatureConfigAppended['x']+this.#signatureConfigAppended['width'],this.#signatureConfigAppended['height']+this.#signatureConfigAppended['y'])));let _0x4520df=this.#$('<div>',{'id':'websign-signature'});_0x4520df[_0x14a95d(0x255)]({'userSelect':_0x14a95d(0x235),'border':'1px\x20solid\x20#000000','position':_0x14a95d(0x24b),'overflow':'hidden','opacity':'0.95','top':_0x256a28['y1']+'px','left':_0x256a28['x0']+'px','width':_0x256a28['x1']-_0x256a28['x0']+'px','height':_0x256a28['y0']-_0x256a28['y1']+'px','cursor':'move','background':_0x14a95d(0x26f),'zIndex':0x64})[_0x14a95d(0x1df)](this.#$('#websign-signature-container')),_0x4520df[_0x14a95d(0x28a)]('websign-antidisabled');let _0x407427=this;_0x4520df[_0x14a95d(0x2fb)]({'containment':_0x14a95d(0x2db),'stop':()=>{_0x407427.#updateSignatureCoordinates();}}),_0x4520df[_0x14a95d(0x2ae)]({'handles':'se','aspectRatio':!![],'minWidth':0x35+0x1e,'minHeight':0x21+0x1e,'containment':_0x14a95d(0x2db),'stop':()=>{_0x407427.#updateSignatureCoordinates();}}),this.#createSignatureButtons();let _0x47a381=this.#$(_0x14a95d(0x1f3),{'id':_0x14a95d(0x212)});_0x47a381[_0x14a95d(0x249)](_0x14a95d(0x284)),_0x47a381['css']({'textAlign':_0x14a95d(0x223),'padding':'10px','margin':_0x14a95d(0x2f3)})[_0x14a95d(0x1df)](this.#$(_0x14a95d(0x217))),this.#status!==this['WebSignStatus'][_0x14a95d(0x311)]&&(this.#consoleLog(_0x14a95d(0x2c8)),this.#centersPdfOnScreenBasedOnSignature(![]),this.#status=this[_0x14a95d(0x238)]['Appended'],this.#consoleLog('websign-\x20createSignature\x20status\x20=\x20appended'));}#createSignatureButtons(){const _0x127442=a0_0x43d3a9;this.#consoleLog(_0x127442(0x201)),this.#$(_0x127442(0x2d2))[_0x127442(0x304)](),this.#$('#websign-signature-progress')[_0x127442(0x304)]();let _0x4bb17a=this.#status===this['WebSignStatus'][_0x127442(0x2b5)];this.#consoleLog(_0x127442(0x30f)+_0x4bb17a);let _0x6da47=this.#$(_0x127442(0x310),{'id':_0x127442(0x2d0)}),_0x31f3fb=navigator[_0x127442(0x1f8)]['toLowerCase']()['indexOf'](_0x127442(0x2ee))>-0x1;if(_0x31f3fb&&!_0x4bb17a)return;let _0x2d622a=0x32;_0x4bb17a&&(_0x2d622a=0x64/0x3);_0x2d622a=_0x2d622a+'%',_0x6da47[_0x127442(0x255)]({'height':_0x127442(0x2d4),'borderBottom':_0x127442(0x2a0)})[_0x127442(0x1df)](this.#$('#websign-signature')),_0x6da47[_0x127442(0x28a)](_0x127442(0x22e));if(_0x4bb17a){let _0x254de4=this.#$(_0x127442(0x2fc),{'id':_0x127442(0x291),'src':new URL(_0x127442(0x293),import.meta[_0x127442(0x257)])[_0x127442(0x2ad)]});_0x254de4[_0x127442(0x255)]({'background':'#0078B0','zIndex':0x3ea,'cursor':_0x127442(0x2cd),'width':_0x2d622a,'paddingTop':0x2,'paddingBottom':0x2,'height':_0x127442(0x312)})['appendTo'](_0x6da47),_0x254de4[_0x127442(0x22f)](()=>{this.#clearSignature();});let _0x3d1291=this.#$(_0x127442(0x310),{'id':'websign-signature-progress'});_0x3d1291[_0x127442(0x255)]({'height':_0x127442(0x319),'borderBottom':'1px\x20solid\x20#000000','backgroundColor':_0x127442(0x21d),'width':'0%','transition':_0x127442(0x1fa)})[_0x127442(0x1df)](this.#$(_0x127442(0x217))),this.#consoleLog(_0x127442(0x29a));document[_0x127442(0x296)](document[_0x127442(0x28f)](_0x127442(0x212)))&&(this.#consoleLog(_0x127442(0x2a3)),document['getElementById'](_0x127442(0x212))[_0x127442(0x304)]());;}var _0x5a258f=this.#$(_0x127442(0x2fc),{'src':new URL('./web/images/annotation-close-bold.svg',import.meta[_0x127442(0x257)])['pathname']});_0x5a258f[_0x127442(0x255)]({'background':_0x127442(0x31a),'zIndex':0x3ea,'cursor':_0x127442(0x2cd),'width':_0x2d622a,'paddingTop':0x2,'paddingBottom':0x2,'height':_0x127442(0x312)})[_0x127442(0x1df)](_0x6da47),_0x5a258f['click'](()=>{this.#resetSignature();});var _0x1b43e0=this.#$('<img>',{'src':new URL(_0x127442(0x2ba),import.meta[_0x127442(0x257)])[_0x127442(0x2ad)]});_0x1b43e0[_0x127442(0x255)]({'background':'#00B020','zIndex':0x3ea,'cursor':'pointer','width':_0x2d622a,'paddingTop':0x2,'paddingBottom':0x2,'height':_0x127442(0x312)})[_0x127442(0x1df)](_0x6da47),_0x1b43e0[_0x127442(0x22f)](()=>{this.#onOkSignatureClick();});}#positionateSignatureOnPDFPage(){const _0x3f9f95=a0_0x43d3a9;this.#consoleLog('websign-positionateSignatureOnPDFPage');let _0x5d9f54=this.#signaturePageView[_0x3f9f95(0x22c)]['viewBox'];if(this.#webSignConfig[_0x3f9f95(0x229)]['type']===this['WebSignWidgetType'][_0x3f9f95(0x2d1)]||this.#webSignConfig[_0x3f9f95(0x229)][_0x3f9f95(0x233)]===this[_0x3f9f95(0x2ac)][_0x3f9f95(0x2e2)]){this.#signatureConfigAppended['x']=this.#webSignConfig[_0x3f9f95(0x229)]['x'],this.#signatureConfigAppended['y']=this.#webSignConfig[_0x3f9f95(0x229)]['y'],this.#signatureConfigAppended[_0x3f9f95(0x1e3)]=this.#webSignConfig[_0x3f9f95(0x229)][_0x3f9f95(0x1e3)],this.#signatureConfigAppended[_0x3f9f95(0x23a)]=this.#webSignConfig['widget']['height'];return;}this.#signatureConfigAppended['x']==null&&(this.#signatureConfigAppended['x']=(_0x5d9f54[0x2]-_0x5d9f54[0x0])/0x2-this.#signatureConfigAppended['width']/0x2),this.#signatureConfigAppended['y']==null&&(this.#signatureConfigAppended['y']=(_0x5d9f54[0x3]-_0x5d9f54[0x1])/0x2-this.#signatureConfigAppended[_0x3f9f95(0x23a)]/0x2);}async #centersPdfOnScreenBasedOnSignature(_0x1eb88c){const _0x1deb45=a0_0x43d3a9;this.#consoleLog('websign-centersPdfOnScreenBasedOnSignature\x20with\x20reescaling:\x20'+_0x1eb88c);let _0x96e747=PDFViewerApplication['pdfViewer']['currentScale'];if(_0x1eb88c){let _0x4dff3d=PDFViewerApplication[_0x1deb45(0x28b)][_0x1deb45(0x28d)],_0x530f95=this.#$('#websign-viewer-container')[0x0]['clientWidth'],_0x5ca035=this.#$('#websign-signature')[0x0][_0x1deb45(0x1f5)],_0x37a746=_0x5ca035/_0x530f95,_0x30f3e9=_0x4dff3d/_0x37a746,_0x582e8d=this.#$(_0x1deb45(0x216))[0x0][_0x1deb45(0x26e)],_0x58c28e=this.#$(_0x1deb45(0x217))[0x0][_0x1deb45(0x26e)],_0xaea088=_0x58c28e/_0x582e8d,_0x3cd330=_0x4dff3d/_0xaea088;_0x96e747=Math[_0x1deb45(0x230)](_0x30f3e9,_0x3cd330),this.#consoleLog('websign-centersPdfOnScreenBasedOnSignature\x20desiredScale\x20to\x20fill\x20signature\x20div\x20on\x20screen:\x20'+_0x96e747),this.#configWidthPx=_0x96e747*_0x5ca035/_0x4dff3d,this.#configHeightPx=_0x96e747*_0x58c28e/_0x4dff3d,this.#consoleLog('websign-centersPdfOnScreenBasedOnSignature\x20scroll\x20page\x20into\x20view');}await this.#scrollAndZoomPage(parseInt(this.#signaturePage),this.#signatureConfigAppended['x'],this.#signatureConfigAppended['y']+this.#signatureConfigAppended['height'],_0x96e747);}#scrollAndZoomPage(_0x5149e3,_0x5577fc,_0x400088,_0x15b83d){const _0x5cffcb=a0_0x43d3a9;return console[_0x5cffcb(0x2da)]('websign-scrollAndZoomPage'),new Promise((_0x254f88,_0x1433ac)=>{const _0xa268f4=_0x5cffcb;try{PDFViewerApplication[_0xa268f4(0x28b)]['scrollPageIntoView']({'pageNumber':_0x5149e3,'destArray':[null,{'name':_0xa268f4(0x314)},_0x5577fc,_0x400088,_0x15b83d],'allowNegativeOffset':!![]});const _0x3f3b90=()=>{const _0x2b08c6=_0xa268f4;console[_0x2b08c6(0x2da)](_0x2b08c6(0x1de));const _0x48d97f=PDFViewerApplication[_0x2b08c6(0x28b)]['getPageView'](_0x5149e3-0x1);_0x48d97f&&_0x48d97f['renderingState']===0x3?_0x254f88():setTimeout(_0x3f3b90,0x64);};_0x3f3b90();}catch(_0x357ebe){_0x1433ac(_0x357ebe);}});}#resetSignature(){const _0x22b421=a0_0x43d3a9;this.#consoleLog(_0x22b421(0x1ef)),this.#setLoading(![]),this.#$(_0x22b421(0x253))[_0x22b421(0x206)](),this.#$(_0x22b421(0x2ef))[_0x22b421(0x1fd)](_0x22b421(0x265)),this.#$('#websign-signature-container')[_0x22b421(0x304)](),this.#$(_0x22b421(0x26d))['show'](0x1f4),this.#$(_0x22b421(0x244))['hide'](0x1f4),this.#$(_0x22b421(0x208))[_0x22b421(0x206)](0x1f4),this.#$(_0x22b421(0x1e0))[_0x22b421(0x206)](0x1f4),this.#signaturePositioned=![],this.#webSignConfig[_0x22b421(0x229)][_0x22b421(0x233)]===this[_0x22b421(0x2ac)]['Fixed']||this.#webSignConfig['widget'][_0x22b421(0x233)]===this[_0x22b421(0x2ac)][_0x22b421(0x2e2)]?this.#signatureConfigAppended={'x':this.#webSignConfig[_0x22b421(0x229)]['x'],'y':this.#webSignConfig[_0x22b421(0x229)]['y'],'width':this.#webSignConfig[_0x22b421(0x229)][_0x22b421(0x1e3)],'height':this.#webSignConfig[_0x22b421(0x229)][_0x22b421(0x23a)]}:this.#signatureConfigAppended={'x':null,'y':null,'width':this.#webSignConfig[_0x22b421(0x229)]['width'],'height':this.#webSignConfig['widget'][_0x22b421(0x23a)]},this.#signaturePage=undefined,this.#status=this[_0x22b421(0x238)]['Initialized'],PDFViewerApplication[_0x22b421(0x28b)][_0x22b421(0x25e)]=_0x22b421(0x2f3),this.#edataliaSigner&&this.#edataliaSigner[_0x22b421(0x2c4)](),document[_0x22b421(0x2b4)](_0x22b421(0x234),this.#preventZoomMouse),document['removeEventListener'](_0x22b421(0x21b),this.#preventCntrlZoom),document[_0x22b421(0x2b4)](_0x22b421(0x2d6),this.#preventMobileZoom);}#clearSignature(){const _0x3d854b=a0_0x43d3a9;this.#consoleLog(_0x3d854b(0x285)),this.#edataliaSigner[_0x3d854b(0x1fb)]();}['downloadURI'](_0x3f22c4,_0x2ac83d){const _0x23e900=a0_0x43d3a9;this.#consoleLog(_0x23e900(0x1e8));let _0x3f64e8=document[_0x23e900(0x2fa)]('a');_0x3f64e8[_0x23e900(0x20f)]=_0x2ac83d,_0x3f64e8['href']=_0x3f22c4,document['body'][_0x23e900(0x269)](_0x3f64e8),_0x3f64e8[_0x23e900(0x22f)](),document[_0x23e900(0x2c6)][_0x23e900(0x1ec)](_0x3f64e8);}async #performSignature(){const _0x41c568=a0_0x43d3a9;this.#consoleLog('websign-performSignature');const _0x523907=await PDFViewerApplication['pdfDocument'][_0x41c568(0x214)](),_0x33e347=await this.#pdfDataToBase64(_0x523907);this.#signDocument(_0x33e347);}#setLoading(_0x3f529b){const _0x21e092=a0_0x43d3a9;this.#consoleLog(_0x21e092(0x219));let _0xc96c2b=this.#$(_0x21e092(0x28c)),_0x17c396=this.#$(_0x21e092(0x2ef)),_0x180756=this.#$(_0x21e092(0x24d));_0x3f529b?(_0xc96c2b['addClass'](_0x21e092(0x1e7)),_0x17c396[_0x21e092(0x28a)](_0x21e092(0x308)),_0x180756[_0x21e092(0x28a)]('websign-disabled')):(_0xc96c2b[_0x21e092(0x1fd)](_0x21e092(0x1e7)),_0x17c396[_0x21e092(0x1fd)]('websign-disabled'),_0x180756['removeClass'](_0x21e092(0x308)));}async #signDocument(_0x4a0e1d,_0x5d368a,_0x199421,_0x5de5b8){const _0x15e357=a0_0x43d3a9;this.#setLoading(!![]);const _0x52c954={'b64PDFContent':_0x4a0e1d,'certificate':this.#webSignConfig[_0x15e357(0x222)],'widget':{'b64Image':_0x5de5b8,'page':this.#signaturePage,'x':Math[_0x15e357(0x258)](this.#signatureConfigAppended['x']),'y':Math[_0x15e357(0x258)](this.#signatureConfigAppended['y']),'width':Math[_0x15e357(0x258)](this.#signatureConfigAppended[_0x15e357(0x1e3)]),'height':Math[_0x15e357(0x258)](this.#signatureConfigAppended[_0x15e357(0x23a)]),'customText':this.#webSignConfig[_0x15e357(0x229)][_0x15e357(0x2ea)]},'properties':this.#webSignConfig[_0x15e357(0x31d)],'options':this.#webSignConfig[_0x15e357(0x2c5)],'timestampProvider':this.#webSignConfig[_0x15e357(0x239)],'ocspProvider':this.#webSignConfig['ocspProvider'],'b64PublicBioData':_0x5d368a,'b64PrivateBioData':_0x199421},_0x5f0d3f=this[_0x15e357(0x2b3)]()+_0x15e357(0x2ab);_0x52c954['properties'][_0x15e357(0x2a4)]='\x20',_0x52c954['properties'][_0x15e357(0x1f7)]='\x20',fetch(_0x5f0d3f,{'method':'POST','headers':{'Content-Type':_0x15e357(0x292),'Authorization':_0x15e357(0x1e1)+this.#webSignConfig['bearerToken']},'body':JSON[_0x15e357(0x2a8)](_0x52c954)})[_0x15e357(0x2b7)](async _0x477975=>{const _0x287884=_0x15e357;if(_0x477975['ok']){var _0xb13f79=await _0x477975['blob']();this.#processCommonOnSigned(_0xb13f79);return;}throw new Error(_0x287884(0x2eb)+_0x477975[_0x287884(0x225)]);})[_0x15e357(0x295)](_0x2adcec=>{const _0x53bc60=_0x15e357;this.#callback({'type':_0x53bc60(0x271),'error':_0x2adcec}),this.#resetSignature(),this.#showErrorSignatureMessage(_0x2adcec);});}[a0_0x43d3a9(0x2b3)](){const _0x4037c7=a0_0x43d3a9;let _0x174d25=_0x4037c7(0x218);if(this.#webSignConfig['signatureEnvironment']===_0x4037c7(0x2e3))_0x174d25=_0x4037c7(0x301);else this.#webSignConfig['signatureEnvironment']===_0x4037c7(0x2ce)&&(_0x174d25=_0x4037c7(0x2e8));return _0x174d25;}#pdfDataToBase64(_0x3897c4){const _0x129e1b=a0_0x43d3a9;return this.#consoleLog(_0x129e1b(0x30c)),new Promise((_0x17df31,_0x5b64c8)=>{const _0x53ff18=_0x129e1b,_0x1c7308=new Blob([_0x3897c4],{'type':_0x53ff18(0x1e6)}),_0x47f446=new FileReader();_0x47f446[_0x53ff18(0x1f2)]=()=>{const _0x21953f=_0x53ff18;_0x17df31(_0x47f446[_0x21953f(0x254)][_0x21953f(0x282)](',')[0x1]);},_0x47f446[_0x53ff18(0x2bb)]=_0x5b64c8,_0x47f446[_0x53ff18(0x302)](_0x1c7308);});}#updateSignatureCoordinates(){const _0x46f81c=a0_0x43d3a9;this.#consoleLog(_0x46f81c(0x297));var _0x5e721c=this.#getPDFSignatureCoordinates();this.#signatureConfigAppended=new EPKSignatureParam(_0x5e721c['x0'],_0x5e721c['y1'],_0x5e721c['x1']-_0x5e721c['x0'],_0x5e721c['y0']-_0x5e721c['y1']);}#getPDFSignatureCoordinates(){const _0x601671=a0_0x43d3a9;this.#consoleLog(_0x601671(0x2bd));var _0x1835d8={'top':parseFloat(this.#$(_0x601671(0x217))[0x0]['style'][_0x601671(0x26b)]),'left':parseFloat(this.#$('#websign-signature')[0x0]['style'][_0x601671(0x20a)])};return this.#screenCoordsToPDFCoords(new EPKCoordintates(_0x1835d8[_0x601671(0x20a)],_0x1835d8[_0x601671(0x26b)],_0x1835d8[_0x601671(0x20a)]+this.#$('#websign-signature')[_0x601671(0x1e3)](),_0x1835d8['top']+this.#$(_0x601671(0x217))['height']()));}#screenCoordsToPDFCoords(_0x59ccfb){const _0x138f4e=a0_0x43d3a9;this.#consoleLog(_0x138f4e(0x2e1));var _0x5b3793=this.#signaturePageView[_0x138f4e(0x22c)][_0x138f4e(0x236)](_0x59ccfb['x0'],_0x59ccfb['y0']),_0x432f52=this.#signaturePageView[_0x138f4e(0x22c)][_0x138f4e(0x236)](_0x59ccfb['x1'],_0x59ccfb['y1']);return new EPKCoordintates(_0x5b3793[0x0],_0x5b3793[0x1],_0x432f52[0x0],_0x432f52[0x1]);}#PDFCoordsToScreenCoords(_0x27ac60){const _0x41e530=a0_0x43d3a9;this.#consoleLog(_0x41e530(0x2de));var _0x10ee2a=this.#signaturePageView[_0x41e530(0x22c)][_0x41e530(0x25a)](_0x27ac60['x0'],_0x27ac60['y0']),_0x3d625d=this.#signaturePageView[_0x41e530(0x22c)]['convertToViewportPoint'](_0x27ac60['x1'],_0x27ac60['y1']);return new EPKCoordintates(_0x10ee2a[0x0],_0x10ee2a[0x1],_0x3d625d[0x0],_0x3d625d[0x1]);}async #loadSyncScript(_0x1e10f8,_0x4a8d98=![]){const _0x2a8e61=a0_0x43d3a9;this.#consoleLog(_0x2a8e61(0x242));if(!_0x4a8d98){let _0x399520=document[_0x2a8e61(0x2f9)](_0x2a8e61(0x315));for(var _0x37836f=0x0;_0x37836f<_0x399520[_0x2a8e61(0x259)];_0x37836f++){if(_0x399520[_0x37836f][_0x2a8e61(0x243)]===window[_0x2a8e61(0x248)][_0x2a8e61(0x20d)]+_0x1e10f8)return;}}var _0x5eca13=document['createElement'](_0x2a8e61(0x315));return _0x5eca13[_0x2a8e61(0x243)]=_0x1e10f8,_0x5eca13['async']=![],document[_0x2a8e61(0x2f5)][_0x2a8e61(0x269)](_0x5eca13),new Promise((_0x4d9155,_0x154bb0)=>{const _0x34bc94=_0x2a8e61;_0x5eca13[_0x34bc94(0x27a)]=()=>{_0x4d9155();};});}#loadJQuery(){const _0x45538e=a0_0x43d3a9;return this.#consoleLog(_0x45538e(0x307)),new Promise((_0x49072f,_0x4a4ed3)=>{const _0x3845da=_0x45538e;let _0x4939c6=document[_0x3845da(0x2fa)](_0x3845da(0x315));_0x4939c6['src']=('src',new URL('./build/jquery.min.js',import.meta[_0x3845da(0x257)])[_0x3845da(0x2ad)]),_0x4939c6['onload']=()=>{const _0x401bbf=_0x3845da;jQuery[_0x401bbf(0x211)]({'type':_0x401bbf(0x1e9),'url':new URL(_0x401bbf(0x2d5),import.meta[_0x401bbf(0x257)])[_0x401bbf(0x2ad)],'dataType':_0x401bbf(0x315),'async':![]}),jQuery[_0x401bbf(0x211)]({'type':'GET','url':new URL(_0x401bbf(0x2e4),import.meta[_0x401bbf(0x257)])[_0x401bbf(0x2ad)],'dataType':_0x401bbf(0x315),'async':![]}),this.#$=jQuery[_0x401bbf(0x252)](!![]),this.#$(_0x401bbf(0x2f5))[_0x401bbf(0x2a7)](this.#$('<link\x20rel=\x22stylesheet\x22\x20type=\x22text/css\x22\x20/>')[_0x401bbf(0x281)](_0x401bbf(0x205),new URL(_0x401bbf(0x2f6),import.meta['url'])[_0x401bbf(0x2ad)])),_0x49072f();},document['head'][_0x3845da(0x269)](_0x4939c6);});}async #getTextPageCoordinates(){const _0x506afd=a0_0x43d3a9;this.#consoleLog(_0x506afd(0x278));for(var _0x43e35f=0x1;_0x43e35f<=PDFViewerApplication[_0x506afd(0x2c2)]['numPages'];_0x43e35f++){var _0x1c1a47=await PDFViewerApplication[_0x506afd(0x2c2)][_0x506afd(0x2cc)](_0x43e35f),_0x2f01e6=await _0x1c1a47['getTextContent']();for(var _0x5e2061=0x0;_0x5e2061<_0x2f01e6['items']['length'];_0x5e2061++){var _0x5f2714=_0x2f01e6[_0x506afd(0x23d)][_0x5e2061];if(_0x5f2714[_0x506afd(0x250)][_0x506afd(0x24e)](this.#webSignConfig['widget'][_0x506afd(0x306)]))return[_0x43e35f,_0x5f2714[_0x506afd(0x288)][0x4],_0x5f2714[_0x506afd(0x288)][0x5]];}}return null;}#disableButtons(){const _0x1b96fe=a0_0x43d3a9;this.#$(_0x1b96fe(0x244))[_0x1b96fe(0x255)]({'pointer-events':_0x1b96fe(0x235),'opacity':_0x1b96fe(0x27d)}),this.#$('#websign-fab-ok')[_0x1b96fe(0x255)]({'pointer-events':_0x1b96fe(0x235),'opacity':'0.6'}),this.#$(_0x1b96fe(0x1e0))[_0x1b96fe(0x255)]({'pointer-events':'none','opacity':'0.6'}),this.#$(_0x1b96fe(0x2d2))[_0x1b96fe(0x1fd)](_0x1b96fe(0x22e)),this.#$(_0x1b96fe(0x2d2))['css']({'pointer-events':'none','opacity':_0x1b96fe(0x27d)});}#enableButtons(){const _0x2812b4=a0_0x43d3a9;this.#$('#websign-fab-clear')[_0x2812b4(0x255)]({'pointer-events':_0x2812b4(0x2f3),'opacity':'1'}),this.#$(_0x2812b4(0x208))[_0x2812b4(0x255)]({'pointer-events':'auto','opacity':'1'}),this.#$(_0x2812b4(0x1e0))[_0x2812b4(0x255)]({'pointer-events':'auto','opacity':'1'}),this.#$(_0x2812b4(0x2d2))[_0x2812b4(0x28a)](_0x2812b4(0x22e)),this.#$(_0x2812b4(0x2d2))[_0x2812b4(0x255)]({'pointer-events':_0x2812b4(0x2f3),'opacity':'1'});}}class EPKSignatureParam{constructor(_0x10c23a,_0x4fc426,_0x51bc93,_0x573175){const _0xfd43c8=a0_0x43d3a9;this['x']=_0x10c23a,this['y']=_0x4fc426,this[_0xfd43c8(0x1e3)]=_0x51bc93,this[_0xfd43c8(0x23a)]=_0x573175;}}class EPKCoordintates{constructor(_0xd1dd30,_0x57ea46,_0x27bbd3,_0x1a106f){this['x0']=_0xd1dd30,this['y0']=_0x57ea46,this['x1']=_0x27bbd3,this['y1']=_0x1a106f;}}